{% extends "base_generic.html" %}

{% block content %}

{% if user.is_authenticated %}
<ul>
  {% if event %}
  <!-- {$ if item.date_and_time < %} -->
  <li>Event Title: {{ event.title }}</li>
  <li>Summary: {{ event.summary }}</li>
  <li>Date and Time: {{ event.date_and_time }}</li>
  <li> Owners:
    <ul>
      {% if event.owner %}
      {% for item in event.owner.all %}
      <li> {{ item.username }} </li>
      {% endfor %}
      {% endif %}
      <button onclick="myFunction('addOwner')">Add Owner</button>

      <div id="addOwner" style="display:none">
	<form action="/rsvp/event/{{ event.pk }}/add_owner" method="post">
	  {% csrf_token %}
	  Username: <input type="text" name="text" required >
	  <button type="submit" formmethod="post">Submit</button>
	</form>
      </div>
    </ul>
  </li>
  
  <li> Vendors:
    <ul>
      {% if event.vendor_set %}
      {% for item in event.vendor_set.all %}
      <li> {{ item.people.username }} </li>
      {% endfor %}
      {% endif %}
      <button onclick="myFunction('addVendor')">Add Vendor</button>
      <div id="addVendor" style="display:none">
	<form action="/rsvp/event/{{ event.pk }}/add_vendor" method="post">
	  {% csrf_token %}
	  Username: <input type="text" name="text" required >
	  <button type="submit" formmethod="post">Submit</button>
	</form>
      </div>
    </ul>
  </li>
  <li> Guests:
    <ul>
      {% if event.guest_set %}
      {% for item in event.guest_set.all %}
      <li> {{ item.people.username }} has
	{% if item.response == 0 %}
	not decided
	{% endif %}
	{% if item.response == -1 %}
	decided not to come
	{% endif %}
	{% if item.response == 1 %}
	decided to come
	{% endif %}
	<a href="/rsvp/event/{{ event.pk }}/remove_guest?id={{ item.people.pk }}"> remove </a>
      </li>
      {% endfor %}
      {% endif %}
      <button onclick="myFunction('addGuest')">Add Guest</button>
      <div id="addGuest" style="display:none">
	<form action="/rsvp/event/{{ event.pk }}/add_guest" method="post">
	  {% csrf_token %}
	  Username: <input type="text" name="text" required >
	  <button type="submit" formmethod="post">Submit</button>
	</form>
      </div>
    </ul>
  {% else %}
  <p> Error: No event found!</p>
  {% endif %}
</ul>
{% else %}
<p> Please <a href="{% url 'login' %}?next={{ next }}"> login </a>  </p>
{% endif %}

<p> <a href="{% url 'create_question' %}?id={{ event.pk }}"> New Question </a> </p>
<script>
  function myFunction(blk) {
  var x = document.getElementById(blk);
  if (x.style.display === "none") {
  x.style.display = "block";
  } else {
  x.style.display = "none";
  }
  }
</script>
{% endblock %}
